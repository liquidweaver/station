<html>
<head>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script defer>
		function loadAssets(sources, callback) {
			var assetDir = 'sprites/';
			var imageExtension = '.dmi';
			var metaExtension = '.meta';
			var images = {};
			var loadedAssets = 0;
			var numAssets = Object.keys(sources).length * 2;

			for(var src in sources) {
				images[src] = new Image();
				images[src].onload = function() {
					if(++loadedAssets >= numAssets) {
						callback(images);
					}
				};
				images[src].src = assetDir + sources[src] + imageExtension;
				images[src].meta = $.get(  assetDir + sources[src] + metaExtension, function() {
					if(++loadedAssets >= numAssets) {
						callback(images);
					}
				});
			}
		}

		var sources = {
			floors: 'floors',
		};

		loadAssets(sources, function() {
			console.log("done");
		});

</script>
</head>
<body>
</body>
</html>
